.\" Generated by Mmark Markdown Processer - mmark.miek.nl
.TH "PGOCTL" 1 "May 2023" "System Administration" "Podman Compose"

.SH "PGOCTL"
.SH "NAME"
.PP
pgoctl - interact remotely with pgod(8)

.SH "SYNOPSIS"
.PP
\fB\fCpgoctl [OPTION]...\fR \fIhost\fP:\fIname\fP//\fIcommands\fP

.SH "DESCRIPTION"
.PP
pgoctl is an utility to inspect and control pgod(8) remotely.

.PP
There are only a few options:

.TP
\fB-i value\fP
identity file to use for SSH, this flag is mandatory. You can use \fB\fC'$VAR'\fR then the private key
will be read from the environment variable \fB\fCVAR\fR. Note the "$" must be the first character of value
and must be quoted, i.e. it should not be expanded by the shell.
.TP
\fB--help, -h\fP
show help
.TP
\fB--port, -p port\fP
remote port number to use (defaults to 2222)


.PP
Start pgod(8) and look at some services:

.PP
.RS

.nf
% sudo ./cmd/pgod/pgod \-c config.toml
2023/05/19 08:34:47 [INFO ] Service "pgo" with upstream "https://github.com/miekg/pgo"
2023/05/19 08:34:47 [INFO ] Launched tracking routine for "pgo"
2023/05/19 08:34:47 [INFO ] Launched servers on port :2222 (ssh)

.fi
.RE

.PP
Then up the services, if not done already:

.PP
.RS

.nf
% cmd/pgoctl/pgoctl \-i ssh/id\_pgo4 localhost:pgo//up
61380c3c0cbe9827f335b5d6e7690d3a366317f755d87f969fcd9b1cb4b2254c
['podman', '\-\-version', '']
using podman version: 3.4.4
** excluding:  set()
['podman', 'network', 'exists', 'pgo\-3493677287\_default']
podman run \-\-name=pgo\-3493677287\_frontend\_1 \-d \-\-label my.label=my\_value \-\-label io.podman.compose.config\-hash=123 \-\-label io.podman.compose.project=pgo\-3493677287 \-\-label io.podman.compose.version=0.0.1 \-\-label com.docker.compose.project=pgo\-3493677287 \-\-label com.docker.compose.project.working\_dir=/tmp/pgo\-3493677287 \-\-label com.docker.compose.project.config\_files=docker\-compose.yml \-\-label com.docker.compose.container\-number=1 \-\-label com.docker.compose.service=frontend \-e SECRET\_KEY2=aabbcc \-e ENV\_IS\_SET2 \-\-net pgo\-3493677287\_default \-\-network\-alias frontend \-p 8080 \-w / busybox /bin/busybox httpd \-f \-p 8080
exit code: 0%

.fi
.RE

.PP
Looking at the \fB\fCps\fR:

.PP
.RS

.nf
% cmd/pgoctl/pgoctl \-i ssh/id\_pgo4 localhost:pgo//ps
CONTAINER ID  IMAGE                             COMMAND               CREATED             STATUS                 PORTS                    NAMES
61380c3c0cbe  docker.io/library/busybox:latest  /bin/busybox http...  About a minute ago  Up About a minute ago  0.0.0.0:36391\->8080/tcp  pgo\-3493677287\_frontend\_1
['podman', '\-\-version', '']
using podman version: 3.4.4
podman ps \-a \-\-filter label=io.podman.compose.project=pgo\-3493677287
exit code: 0%

.fi
.RE

.SH "ALSO SEE"
.PP
See this design doc
\[la]https://miek.nl/2022/november/15/provisioning-services/\[ra], and
gitopper
\[la]https://github.com/miekg/gitopper\[ra]. And see pgod(8) podman-compose(1).

